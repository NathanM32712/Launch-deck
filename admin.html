<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Admin Panel</title>
  <link rel="icon" type="image/png" href="icon.png" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <style>
    body {
      margin: 0;
      background: #021a30;
      color: #cfefff;
      font-family: Segoe UI, Roboto, system-ui, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    /* Back button */
    #backButton {
      position: fixed;
      top: 10px;
      left: 10px;
      width: 40px;
      height: 40px;
      background-image: url('icon.png');
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      cursor: pointer;
      z-index: 9999;
    }

    .card {
      width: 520px;
      background: #06273f;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.6);
      max-height: 90vh;
      overflow-y: auto;
    }

    h2 {
      margin: 0 0 12px 0;
      color: #48b0ff;
    }

    p {
      margin: 6px 0;
      color: #9bd6ff;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }

    th, td {
      border: 1px solid #14405f;
      padding: 8px;
      font-size: 14px;
    }

    th {
      background: #08314a;
      color: #9bd6ff;
    }

    input[type="text"] {
      width: 100%;
      padding: 8px;
      border-radius: 6px;
      border: none;
      background: #08314a;
      color: #cfefff;
      margin-top: 4px;
      box-sizing: border-box;
    }

    button {
      margin-top: 10px;
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: none;
      background: linear-gradient(180deg,#48b0ff,#1e90ff);
      color: #001;
      font-weight: bold;
      cursor: pointer;
    }

    .danger {
      background: linear-gradient(180deg,#ff8a8a,#ff5a5a);
    }

    .small {
      font-size: 13px;
      color: #9bd6ff;
      margin-top: 8px;
    }
  </style>
</head>

<body>

<a id="backButton" href="launch-deck.html"></a>

<div class="card" id="card" aria-live="polite">
  <h2>Admin Panel</h2>
  <p id="status">Checking admin cookie...</p>

  <div id="adminUI" style="display:none;">

    <h3 style="color:#48b0ff;margin-top:20px;">Cookie Editor</h3>
    <p class="small">Edit or delete any cookie stored by this site.</p>

    <table id="cookieTable">
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Actions</th>
      </tr>
    </table>

    <button id="logoutBtn" class="danger">Remove Admin Cookie</button>
  </div>
</div>

<script>
(function(){

  function isAdmin() {
    return localStorage.getItem("admin") === "true";
  }

  if (!isAdmin()) {
    document.getElementById("status").textContent = "Access denied. Redirecting...";
    setTimeout(() => location.href = "launch-deck.html", 600);
    return;
  }

  document.getElementById("status").style.display = "none";
  document.getElementById("adminUI").style.display = "block";

  function loadCookies() {
    const table = document.getElementById("cookieTable");
    table.innerHTML = `
      <tr>
        <th>Name</th>
        <th>Value</th>
        <th>Actions</th>
      </tr>
    `;
    const cookies = document.cookie.split("; ");
    cookies.forEach(cookie => {
      if (!cookie) return;
      const [name, ...valueParts] = cookie.split("=");
      const value = decodeURIComponent(valueParts.join("="));
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${name}</td>
        <td><input type="text" id="edit-${name}" value="${value}"></td>
        <td>
          <button onclick="saveCookie('${name}')">Save</button>
          <button class="danger" onclick="deleteCookie('${name}')">Delete</button>
        </td>
      `;
      table.appendChild(row);
    });
  }

  window.saveCookie = function(name) {
    const newVal = document.getElementById("edit-" + name).value;
    document.cookie = name + "=" + encodeURIComponent(newVal) + "; path=/;";
    loadCookies();
  };

  window.deleteCookie = function(name) {
    document.cookie = name + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
    loadCookies();
  };

  loadCookies();

  document.getElementById("logoutBtn").addEventListener("click", () => {
    localStorage.removeItem("admin");
    location.href = "launch-deck.html";
  });

})();
</script>

</body>
</html>
